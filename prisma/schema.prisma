// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

enum UserType {
  ADMIN
  USER
}

enum UserSituation {
  ATIVO
  INATIVO
}

enum Status {
  ACEITO
  FINALIZADO
  CANCELADO
}

enum PaymentMethods {
  CARTAO_DE_CREDITO
  BOLETO
  PIX
}

enum DeliveryModality {
  RETIRADA
  ENTREGA
}

enum Unit {
  KG
  UN
}

enum Category {
  DOCE
  SALGADO
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  
}

model User {
  id          Int           @id @default(autoincrement())
  nome        String
  email       String
  senha       String
  nivelAcesso UserType @map("nivel_acesso")
  createdAt DateTime
  updatedAt DateTime
  situacao    UserSituation
  clientes Client[]
  produtos Product[]
  pedidos Request[]


  @@map("usuario")
}

model Client {
  id       Int           @id @default(autoincrement()) 
  nome     String
  telefone String?
  email    String?
  createdAt DateTime
  updatedAt DateTime
  endereco  Address?
  pedidos  Request[]
  usuario User @relation(fields: [usuarioId], references: [id])
  usuarioId Int @map("usuario_id")

  @@map("cliente")
}

model Address {
  id          Int    @id @default(autoincrement())
  cep         String
  cidade      String
  bairro      String
  rua         String
  numero      String
  complemento String?
  cliente     Client @relation(fields: [clienteId], references: [id])
  clienteId   Int @unique @map("cliente_id")
  createdAt   DateTime
  updatedAt   DateTime

  @@map("endereco")
}

model ProductImages {
  id          Int    @id @default(autoincrement())
  path        String
  produto     Product @relation(fields: [produtoId], references: [id])
  produtoId   Int  @map("produto_id")
 

  @@map("imagem_produto")
}

model Product {
  id                Int          @id @default(autoincrement())
  createdAt         DateTime
  updatedAt         DateTime
  descricao         String
  categoria         Category     
  unidade           Unit
  itensPedido       RequestItem[] 
  imagensProduto    ProductImages[]
  usuario User @relation(fields: [usuarioId], references: [id])
  usuarioId Int @map("usuario_id")
  

  @@map("produto")
}

model Request {
  id                Int      @id @default(autoincrement())
  createdAt         DateTime
  updatedAt         DateTime
  cliente           Client   @relation(fields: [clienteId], references: [id])
  clienteId         Int @map("cliente_id")
  dataPedido        DateTime @default(now()) @map("data_pedido")
  dataEntrega       DateTime @map("data_entrega")
  status            Status  
  formaPagamento    PaymentMethods @map("forma_pagamento")
  modalidadeEntrega DeliveryModality @map("modalidade_entrega")
  itensPedido       RequestItem[]
  observacao        String?
  usuario User @relation(fields: [usuarioId], references: [id])
  usuarioId Int @map("usuario_id")

  @@map("pedido")
}

model RequestItem {
  id            Int         @id @default(autoincrement())
  pedido        Request     @relation(fields: [pedidoId], references: [id])
  pedidoId      Int   @map("pedido_id")
  produto       Product     @relation(fields: [produtoId], references: [id])
  produtoId     Int  @map("produto_id")
  quantidade    Int
  observacao    String?
  valorUnitario Float @map("valor_unitario")

  @@map("item_pedido")
}
