// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

enum UserType {
  ADMIN
  USER
}

enum UserSituation {
  ATIVO
  INATIVO
}

enum Status {
  ACEITO
  FINALIZADO
  CANCELADO
}

enum PaymentMethods {
  CARTAO_DE_CREDITO
  BOLETO
  PIX
}

enum DeliveryModality {
  RETIRADA
  ENTREGA
}

enum Unit {
  KG
  UN
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  
}

model Category {
  id            Int          @id @default(autoincrement())
  descricao     String 
  produtos      Product[]

  @@map("categoria")
}

model Variation {
  id            Int          @id @default(autoincrement())
  descricao     String
  produtos       Product[]

  @@map("variacao")
}

model User {
  id          Int           @id @default(autoincrement())
  nome        String
  email       String
  senha       String
  nivelAcesso UserType @map("nivel_acesso")
  situacao    UserSituation

  @@map("usuario")
}

model Client {
  id       Int           @id @default(autoincrement())
  nome     String
  telefone String?
  email    String?
  endereco  Address?
  pedidos  Request[]

  @@map("cliente")
}

model Address {
  id          Int    @id @default(autoincrement())
  cep         String
  cidade      String
  bairro      String
  rua         String
  numero      String
  complemento String?
  cliente     Client @relation(fields: [clienteId], references: [id])
  clienteId   Int @unique @map("cliente_id")

  @@map("endereco")
}

model ProductImages {
  id          Int    @id @default(autoincrement())
  path        String
  produto     Product @relation(fields: [produtoId], references: [id])
  produtoId   Int  @map("produto_id")

  @@map("imagem_produto")
}

model Product {
  id                Int          @id @default(autoincrement())
  descricao         String
  categoriaId       Int          @map("categoria_id")      
  categoria         Category     @relation(fields: [categoriaId], references: [id])
  variacaoId        Int          @map("variacao_id")   
  variacao          Variation    @relation(fields: [variacaoId], references: [id])
  unidade           Unit
  itensPedido       RequestItem[] 
  imagensProduto    ProductImages[]

  @@map("produto")
}

model Request {
  id                Int      @id @default(autoincrement())
  cliente           Client   @relation(fields: [clienteId], references: [id])
  clienteId         Int @map("cliente_id")
  dataPedido        DateTime @default(now()) @map("data_pedido")
  dataEntrega       DateTime @map("data_entrega")
  status            Status  
  formaPagamento    PaymentMethods @map("forma_pagamento")
  modalidadeEntrega DeliveryModality @map("modalidade_entrega")
  itensPedido       RequestItem[]
  observacao        String?

  @@map("pedido")
}

model RequestItem {
  id            Int         @id @default(autoincrement())
  pedido        Request     @relation(fields: [pedidoId], references: [id])
  pedidoId      Int   @map("pedido_id")
  produto       Product     @relation(fields: [produtoId], references: [id])
  produtoId     Int  @map("produto_id")
  quantidade    Int
  observacao    String?
  valorUnitario Float @map("valor_unitario")

  @@map("item_pedido")
}
